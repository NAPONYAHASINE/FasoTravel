import{c as ce,r as u,E as ge,I as Ge,y as le,F as ze,P as We,Q as Qe,T as Ye,U as Pe,u as Je,p as O,e as Ne,j as e,m as y,f as ne,b as oe,C as Me,V as Ke,O as Ae,q as E,l as fe,W as Ze,t as N,g as ie,X as Re,Y as Ie,Z as Le,_ as es,$ as ss,H as Fe,n as Ve,K as ts,h as as,w as ve,a0 as rs,A as ls,D as I}from"./index-BY9tNBYj.js";import{W as $,j as ns,D as K,U as A,T as _,S as is,C as h,M as $e,x as q,a0 as je,R as V,B as R,y as S,L as z,al as me,A as ds,E as cs,F as os,G as xs,H as ms,aj as X,V as hs,am as de,an as J,X as ue,Y as pe,h as gs,g as us,ao as ps,ap as js,m as bs,_ as ys,z as Ns,l as ke,a1 as fs,I as we,J as Ce,K as Se,O as Te,Q as L,ad as vs,ak as ks,a8 as ws,a9 as Cs,aa as Ss,ab as Ts,ac as Ds,ae as F}from"./useFilteredData-CPVRhlNB.js";import{C as se,P as Be}from"./printer-LnlBVi6Z.js";import{D as ae,U as he}from"./upload-B9j3UJyu.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Ps=ce("funnel",zs);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ms=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],De=ce("refresh-cw",Ms);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const As=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],re=ce("shopping-cart",As);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],te=ce("wallet",Rs),Is=({tickets:c,cashTransactions:b,cashierId:g,limit:x=5})=>{const i=u.useMemo(()=>ge(c,"purchaseDate").filter(l=>l.cashierId===g&&(l.status==="valid"||l.status==="used")),[c,g]),m=u.useMemo(()=>Ge(c,"purchaseDate").filter(l=>l.cashierId===g&&(l.status==="valid"||l.status==="used")),[c,g]),r=u.useMemo(()=>{const l=le(i),o=i.length,s=ge(b,"timestamp").filter(j=>j.cashierId===g&&j.status==="completed"),d=ze(s);return{totalSales:l,ticketCount:o,cashBalance:d}},[i,b,g]),a=u.useMemo(()=>{const l=le(m),o=We(r.totalSales,l);return{trend:Ye(o),changeFormatted:Qe(o)}},[m,r.totalSales]),n=u.useMemo(()=>Pe(i,"purchaseDate","desc").slice(0,x),[i,x]);return{myTodayTickets:i,myYesterdayTickets:m,todayStats:r,salesTrend:a,recentSales:n}};function Ls(){const c=Je(),{user:b}=O(),{tickets:g,cashTransactions:x,trips:i}=$(),{todayStats:m,salesTrend:r,recentSales:a}=Is({tickets:g,cashTransactions:x,cashierId:b?.id||"",limit:5}),{upcomingTrips:n}=ns(i,4),l=[{title:"Ventes du Jour",value:Ne(m.totalSales),change:r.changeFormatted,trend:r.trend,icon:K,color:"green",subtitle:"FCFA"},{title:"Billets Vendus",value:m.ticketCount.toString(),change:"Aujourd'hui",trend:"neutral",icon:re,color:"yellow",subtitle:"Transactions"},{title:"Caisse",value:Ne(m.cashBalance),change:"En main",trend:"neutral",icon:A,color:"red",subtitle:"FCFA"},{title:"Prochains DÃ©parts",value:n.length.toString(),change:"4h",trend:"neutral",icon:_,color:"green",subtitle:"Disponibles"}];return b?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:l.map((o,s)=>e.jsx(is,{...o},s))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(h,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Ventes RÃ©centes"}),e.jsx("button",{onClick:()=>c("/caissier/historique"),className:"text-sm text-[#f59e0b] hover:text-[#d97706] font-medium",children:"Voir tout"})]}),a.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[e.jsx(re,{size:48,className:"mx-auto mb-3 opacity-30"}),e.jsx("p",{children:"Aucune vente rÃ©cente"})]}):e.jsx("div",{className:"space-y-3",children:a.map(o=>e.jsxs("div",{className:"p-4 rounded-lg border border-gray-200 dark:border-gray-700 hover:border-[#f59e0b] transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:o.passengerName}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[o.departure," â†’ ",o.arrival]})]}),e.jsx("p",{className:"font-bold text-[#f59e0b]",children:y(o.price)})]}),e.jsx("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:e.jsx("span",{children:ne(o.purchaseDate)})})]},o.id))})]}),e.jsxs(h,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Prochains DÃ©parts"}),e.jsx("button",{onClick:()=>c("/caissier/vente"),className:"text-sm text-[#f59e0b] hover:text-[#d97706] font-medium",children:"Vendre"})]}),n.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[e.jsx($e,{size:48,className:"mx-auto mb-3 opacity-30"}),e.jsx("p",{children:"Aucun dÃ©part imminent"})]}):e.jsx("div",{className:"space-y-3",children:n.map(o=>{const s=oe(o);return e.jsxs("div",{className:"p-4 rounded-lg border border-gray-200 dark:border-gray-700 hover:border-[#f59e0b] transition-colors cursor-pointer",onClick:()=>c("/caissier/vente"),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"font-medium text-gray-900 dark:text-white mb-1",children:[o.departure," â†’ ",o.arrival]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Me,{size:14}),e.jsx("span",{children:ne(o.departureTime)})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(A,{size:14}),e.jsxs("span",{children:[o.availableSeats," places"]})]})]})]}),e.jsx("p",{className:"font-bold text-[#f59e0b]",children:y(o.price)})]}),e.jsx("div",{className:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full transition-all rounded-full",style:{width:`${s}%`,backgroundColor:s>=80?"#16a34a":s>=50?"#f59e0b":"#dc2626"}})})]},o.id)})})]})]}),e.jsxs(h,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Actions Rapides"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("button",{onClick:()=>c("/caissier/vente"),className:"p-6 rounded-lg border-2 border-dashed border-gray-300 dark:border-gray-600 hover:border-[#f59e0b] hover:bg-[#f59e0b]/5 transition-all text-gray-900 dark:text-white",children:[e.jsx(re,{size:32,className:"mx-auto mb-3 text-[#f59e0b]"}),e.jsx("p",{className:"font-medium",children:"Vendre un billet"})]}),e.jsxs("button",{onClick:()=>c("/caissier/caisse"),className:"p-6 rounded-lg border-2 border-dashed border-gray-300 dark:border-gray-600 hover:border-[#16a34a] hover:bg-[#16a34a]/5 transition-all text-gray-900 dark:text-white",children:[e.jsx(K,{size:32,className:"mx-auto mb-3 text-[#16a34a]"}),e.jsx("p",{className:"font-medium",children:"GÃ©rer la caisse"})]}),e.jsxs("button",{onClick:()=>c("/caissier/annulation"),className:"p-6 rounded-lg border-2 border-dashed border-gray-300 dark:border-gray-600 hover:border-[#dc2626] hover:bg-[#dc2626]/5 transition-all text-gray-900 dark:text-white",children:[e.jsx(_,{size:32,className:"mx-auto mb-3 text-[#dc2626]"}),e.jsx("p",{className:"font-medium",children:"Rembourser"})]})]})]})]}):null}function Fs(){const{user:c}=O(),{trips:b,addTicket:g,tickets:x,updateTrip:i}=$(),[m,r]=u.useState(""),[a,n]=u.useState(null),[l,o]=u.useState([]),[s,d]=u.useState([]),[j,D]=u.useState(0),[w,k]=u.useState(""),[B,P]=u.useState(""),[U,Z]=u.useState("cash"),[p,H]=u.useState(!1),[G,ee]=u.useState(!1),W=u.useMemo(()=>Ke(b),[b]),be=u.useMemo(()=>{if(!m)return W;const t=m.toLowerCase();return W.filter(f=>f.departure.toLowerCase().includes(t)||f.arrival.toLowerCase().includes(t))},[W,m]),v=u.useMemo(()=>b.find(t=>t.id===a),[b,a]),Ee=t=>{const f=[],C=Math.ceil(t/4);for(let M=0;M<C;M++){const Q=String.fromCharCode(65+M);for(let Y=1;Y<=4&&f.length<t;Y++)f.push(`${Q}${Y}`)}return f},ye=u.useMemo(()=>v?Ae(x,v.id).map(t=>t.seatNumber):[],[v,x]),Oe=t=>{if(ye.includes(t)){N.error("Ce siÃ¨ge est dÃ©jÃ  occupÃ©");return}if(l.includes(t)){o(l.filter(f=>f!==t)),d(s.filter(f=>f.seatNumber!==t)),s[j]?.seatNumber===t&&(k(""),P(""));return}o([...l,t]),s.length===0&&(k(""),P(""),D(0))},qe=()=>{if(!w.trim()){N.error("Veuillez entrer le nom du passager");return}if(!B.trim()){N.error("Veuillez entrer le numÃ©ro de tÃ©lÃ©phone");return}const t=l[j],f=s.findIndex(C=>C.seatNumber===t),T={seatNumber:t,name:w,phone:B};if(f>=0){const C=[...s];C[f]=T,d(C)}else d([...s,T]);if(j<l.length-1){const C=j+1;D(C);const M=l[C],Q=s.find(Y=>Y.seatNumber===M);Q?(k(Q.name),P(Q.phone)):(k(""),P("")),N.success(`âœ“ Passager validÃ© pour ${t}`)}else N.success("âœ“ Tous les passagers validÃ©s !")},Ue=t=>{D(t);const f=s.find(T=>T.seatNumber===l[t]);f&&(k(f.name),P(f.phone))},He=()=>{if(l.length===0){N.error("Veuillez sÃ©lectionner au moins un siÃ¨ge");return}if(s.length!==l.length){N.error("Veuillez renseigner tous les passagers");return}H(!0)},_e=async()=>{if(!(!v||!c)){ee(!0);try{for(const t of s)g({tripId:v.id,passengerName:t.name,passengerPhone:t.phone,seatNumber:t.seatNumber,price:v.price,commission:void 0,paymentMethod:U,salesChannel:"counter",status:"valid",purchaseDate:ie().toISOString(),cashierId:c.id,cashierName:c.name,gareId:v.gareId,departure:v.departure,arrival:v.arrival,departureTime:v.departureTime});i(v.id,{availableSeats:v.availableSeats-s.length}),await new Promise(t=>setTimeout(t,1500)),N.success(`âœ… ${s.length} billet(s) vendu(s) avec succÃ¨s!
Montant total: ${y(xe)}`,{duration:5e3}),n(null),o([]),d([]),D(0),k(""),P(""),Z("cash"),H(!1)}catch{N.error("Erreur lors de la vente du billet")}finally{ee(!1)}}},xe=s.reduce(t=>t+(v?.price||0),0),Xe=l[j];return c?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx(q,{}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl text-gray-900 dark:text-white mb-2",children:"Vente de Billets"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"SÃ©lectionnez un trajet puis renseignez les passagers un par un"})]}),!a&&e.jsxs(h,{className:"p-6",children:[e.jsx("h2",{className:"text-xl text-gray-900 dark:text-white mb-4",children:"1. SÃ©lectionnez un trajet"}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx(je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),e.jsx(V,{type:"text",placeholder:"Rechercher une destination...",value:m,onChange:t=>r(t.target.value),className:"pl-10"})]}),e.jsx("div",{className:"space-y-3",children:be.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[e.jsx(A,{size:48,className:"mx-auto mb-3 opacity-30"}),e.jsx("p",{className:"text-lg",children:"Aucun trajet disponible"})]}):be.map(t=>e.jsxs(h,{className:"p-4 cursor-pointer hover:border-[#f59e0b] transition-all",onClick:()=>n(t.id),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx($e,{size:18,className:"text-gray-500 dark:text-gray-400"}),e.jsxs("h3",{className:"text-gray-900 dark:text-white",children:[t.departure," â†’ ",t.arrival]}),e.jsxs(R,{variant:t.availableSeats<10?"destructive":"secondary",children:[t.availableSeats," places"]})]}),e.jsx("div",{className:"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-400",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Me,{size:14}),e.jsx("span",{children:E(t.departureTime,{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"})})]})})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl text-[#f59e0b]",children:y(t.price,!1)}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"FCFA"})]})]}),e.jsx("div",{className:"mt-3 w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-[#dc2626] to-[#f59e0b] transition-all",style:{width:`${oe(t)}%`}})})]},t.id))})]}),a&&v&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(h,{className:"lg:col-span-2 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl text-gray-900 dark:text-white mb-1",children:"2. SÃ©lectionnez les siÃ¨ges"}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[v.departure," â†’ ",v.arrival]})]}),e.jsx(S,{variant:"outline",onClick:()=>{n(null),o([]),d([]),D(0),k(""),P("")},children:"Changer de trajet"})]}),e.jsxs("div",{className:"flex items-center gap-6 mb-6 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-200 dark:bg-gray-600 rounded border-2 border-gray-300 dark:border-gray-500"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Disponible"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-[#f59e0b] rounded border-2 border-[#d97706]"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"SÃ©lectionnÃ©"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-[#16a34a] rounded border-2 border-[#15803d]"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"ValidÃ©"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-400 dark:bg-gray-500 rounded border-2 border-gray-500 dark:border-gray-600 opacity-50"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"OccupÃ©"})]})]}),e.jsx("div",{className:"grid grid-cols-4 gap-3",children:Ee(v.totalSeats).map(t=>{const f=ye.includes(t),T=l.includes(t),C=s.some(M=>M.seatNumber===t);return e.jsxs("button",{onClick:()=>Oe(t),disabled:f,className:`
                      h-12 rounded-lg border-2 transition-all relative
                      ${f?"bg-gray-400 dark:bg-gray-500 border-gray-500 dark:border-gray-600 opacity-50 cursor-not-allowed text-gray-700 dark:text-gray-300":C?"bg-[#16a34a] border-[#15803d] text-white shadow-lg":T?"bg-[#f59e0b] border-[#d97706] text-white shadow-lg scale-105":"bg-gray-200 dark:bg-gray-600 border-gray-300 dark:border-gray-500 hover:border-[#f59e0b] hover:scale-105 text-gray-900 dark:text-white"}
                    `,children:[t,C&&e.jsx(fe,{size:14,className:"absolute top-1 right-1"})]},t)})})]}),e.jsx(h,{className:"p-6 h-fit sticky top-6",children:l.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[e.jsx(A,{size:48,className:"mx-auto mb-3 opacity-30"}),e.jsx("p",{children:"SÃ©lectionnez des siÃ¨ges pour commencer"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("h3",{className:"text-lg text-gray-900 dark:text-white mb-4",children:["3. Passagers (",s.length,"/",l.length,")"]}),e.jsx("div",{className:"mb-6 space-y-2",children:l.map((t,f)=>{const T=s.find(M=>M.seatNumber===t),C=f===j;return e.jsx("div",{className:`
                          p-3 rounded-lg border-2 transition-all cursor-pointer
                          ${C?"border-[#f59e0b] bg-[#f59e0b]/10":T?"border-[#16a34a] bg-[#16a34a]/10":"border-gray-300 dark:border-gray-600"}
                        `,onClick:()=>Ue(f),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:T?"bg-[#16a34a]":"bg-[#f59e0b]",children:t}),T?e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"text-gray-900 dark:text-white",children:T.name}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:T.phone})]}):e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:C?"En cours...":"Ã€ renseigner"})]}),T&&e.jsx(fe,{size:18,className:"text-[#16a34a]"})]})},t)})}),e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4 mb-6",children:[e.jsxs("h4",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:["Passager siÃ¨ge ",e.jsx(R,{className:"bg-[#f59e0b]",children:Xe})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(z,{htmlFor:"name",children:"Nom complet *"}),e.jsx(V,{id:"name",type:"text",placeholder:"Nom du passager",value:w,onChange:t=>k(t.target.value)})]}),e.jsxs("div",{children:[e.jsx(z,{htmlFor:"phone",children:"TÃ©lÃ©phone *"}),e.jsx(V,{id:"phone",type:"tel",placeholder:"+226 XX XX XX XX",value:B,onChange:t=>P(t.target.value)})]}),e.jsx(S,{onClick:qe,className:"w-full bg-[#16a34a] hover:bg-[#15803d]",children:j<l.length-1?e.jsxs(e.Fragment,{children:["Valider et suivant ",e.jsx(Ze,{size:18,className:"ml-2"})]}):e.jsxs(e.Fragment,{children:[e.jsx(me,{size:18,className:"mr-2"})," Valider"]})})]})]}),s.length===l.length&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4 mb-4",children:[e.jsx(z,{className:"mb-2 block",children:"Mode de paiement"}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:[{value:"cash",label:"EspÃ¨ces",icon:se},{value:"mobile_money",label:"Mobile Money",icon:se},{value:"card",label:"Carte bancaire",icon:se}].map(t=>e.jsxs("button",{onClick:()=>Z(t.value),className:`
                              p-3 rounded-lg border-2 flex items-center gap-2 transition-all text-gray-900 dark:text-white
                              ${U===t.value?"border-[#f59e0b] bg-[#f59e0b]/10":"border-gray-300 dark:border-gray-600 hover:border-[#f59e0b]"}
                            `,children:[e.jsx(t.icon,{size:18}),e.jsx("span",{className:"text-sm",children:t.label}),U===t.value&&e.jsx(me,{size:18,className:"ml-auto text-[#f59e0b]"})]},t.value))})]}),e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4 mb-4",children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Nombre de billets:"}),e.jsx("span",{className:"text-gray-900 dark:text-white",children:s.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Prix unitaire:"}),e.jsx("span",{className:"text-gray-900 dark:text-white",children:y(v.price)})]}),e.jsxs("div",{className:"flex justify-between text-lg pt-2 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("span",{className:"text-gray-900 dark:text-white",children:"Total:"}),e.jsx("span",{className:"text-[#f59e0b]",children:y(xe)})]})]})}),e.jsxs(S,{onClick:He,className:"w-full bg-[#16a34a] hover:bg-[#15803d] text-white",size:"lg",children:[e.jsx(se,{className:"mr-2",size:20}),"Valider la vente"]})]})]})})]}),e.jsx(ds,{open:p,onOpenChange:H,children:e.jsxs(cs,{className:"max-w-2xl",children:[e.jsxs(os,{children:[e.jsx(xs,{children:"Confirmer la vente"}),e.jsx(ms,{children:"VÃ©rifiez les informations avant de valider"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"flex justify-between pb-3 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Trajet:"}),e.jsxs("span",{className:"text-gray-900 dark:text-white",children:[v?.departure," â†’ ",v?.arrival]})]}),e.jsxs("div",{className:"flex justify-between pb-3 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"DÃ©part:"}),e.jsx("span",{className:"text-gray-900 dark:text-white",children:v&&E(v.departureTime)})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Passagers:"}),e.jsx("div",{className:"space-y-2",children:s.map(t=>e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-50 dark:bg-gray-700/30 rounded",children:[e.jsx(R,{className:"bg-[#f59e0b]",children:t.seatNumber}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-900 dark:text-white",children:t.name}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:t.phone})]})]},t.seatNumber))})]}),e.jsxs("div",{className:"flex justify-between pb-3 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Paiement:"}),e.jsx("span",{className:"text-gray-900 dark:text-white",children:X(U)})]}),e.jsxs("div",{className:"flex justify-between text-lg pt-3 border-t-2 border-gray-300 dark:border-gray-600",children:[e.jsx("span",{className:"text-gray-900 dark:text-white",children:"Montant total:"}),e.jsx("span",{className:"text-[#f59e0b]",children:y(xe)})]})]}),e.jsxs(hs,{children:[e.jsx(S,{variant:"outline",onClick:()=>H(!1),disabled:G,children:"Annuler"}),e.jsx(S,{onClick:_e,disabled:G,className:"bg-[#16a34a] hover:bg-[#15803d]",children:G?e.jsxs(e.Fragment,{children:[e.jsx(Be,{className:"mr-2 animate-pulse",size:18}),"Impression..."]}):e.jsxs(e.Fragment,{children:[e.jsx(me,{className:"mr-2",size:18}),"Confirmer et imprimer"]})})]})]})})]}):null}function Vs(){const{user:c}=O(),{cashTransactions:b,addCashTransaction:g}=$(),[x,i]=u.useState(!1),[m,r]=u.useState(!1),[a,n]=u.useState(""),[l,o]=u.useState(""),[s,d]=u.useState(""),[j,D]=u.useState(""),w=u.useMemo(()=>ge(b,"timestamp").filter(p=>p.status==="completed"),[b]),k=u.useMemo(()=>{const p=ze(w),H=Re(w),G=Ie(w),{deposits:ee,withdrawals:W}=Le(w);return{balance:p,sales:H,refunds:G,deposits:ee,withdrawals:W}},[w]),B=u.useMemo(()=>es(w),[w]),P=()=>{if(!c)return;const p=parseFloat(a);if(isNaN(p)||p<=0){N.error("Veuillez entrer un montant valide");return}g({type:"deposit",amount:p,method:"cash",description:l||"DÃ©pÃ´t de caisse",cashierId:c.id,cashierName:c.name,timestamp:ie().toISOString(),status:"completed"}),N.success(`DÃ©pÃ´t de ${y(p)} enregistrÃ©`),i(!1),n(""),o("")},U=()=>{if(!c)return;const p=parseFloat(s);if(isNaN(p)||p<=0){N.error("Veuillez entrer un montant valide");return}if(p>k.balance){N.error("Montant insuffisant en caisse");return}g({type:"withdrawal",amount:p,method:"cash",description:j||"Retrait de caisse",cashierId:c.id,cashierName:c.name,timestamp:ie().toISOString(),status:"completed"}),N.success(`Retrait de ${y(p)} enregistrÃ©`),r(!1),d(""),D("")},Z=p=>{switch(p){case"sale":return e.jsx(_,{className:"text-green-600 dark:text-green-400",size:20});case"refund":return e.jsx(de,{className:"text-red-600 dark:text-red-400",size:20});case"deposit":return e.jsx(ae,{className:"text-blue-600 dark:text-blue-400",size:20});case"withdrawal":return e.jsx(he,{className:"text-orange-600 dark:text-orange-400",size:20});default:return e.jsx(K,{className:"text-gray-600 dark:text-gray-400",size:20})}};return c?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx(q,{}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Gestion de Caisse"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Suivez et gÃ©rez votre caisse quotidienne"})]}),e.jsxs(h,{className:"p-6 bg-gradient-to-br from-[#f59e0b] to-[#d97706]",children:[e.jsxs("div",{className:"flex items-center justify-between text-white",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white/80 mb-1",children:"Solde de caisse"}),e.jsx("h2",{className:"text-4xl font-bold",children:y(k.balance)}),e.jsxs("p",{className:"text-sm text-white/60 mt-2",children:[w.length," transactions aujourd'hui"]})]}),e.jsx(re,{size:64,className:"text-white/30"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-6 pt-6 border-t border-white/20",children:[e.jsxs(S,{onClick:()=>i(!0),className:"bg-white/20 hover:bg-white/30 text-white border-white/40",variant:"outline",children:[e.jsx(ae,{className:"mr-2",size:18}),"DÃ©pÃ´t"]}),e.jsxs(S,{onClick:()=>r(!0),className:"bg-white/20 hover:bg-white/30 text-white border-white/40",variant:"outline",children:[e.jsx(he,{className:"mr-2",size:18}),"Retrait"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/20 rounded-lg",children:e.jsx(_,{className:"text-green-600 dark:text-green-400",size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Ventes"}),e.jsx("p",{className:"text-xl font-bold text-gray-900 dark:text-white",children:y(k.sales)})]})]})}),e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-100 dark:bg-red-900/20 rounded-lg",children:e.jsx(de,{className:"text-red-600 dark:text-red-400",size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Remboursements"}),e.jsx("p",{className:"text-xl font-bold text-gray-900 dark:text-white",children:y(k.refunds)})]})]})}),e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:e.jsx(ae,{className:"text-blue-600 dark:text-blue-400",size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"DÃ©pÃ´ts"}),e.jsx("p",{className:"text-xl font-bold text-gray-900 dark:text-white",children:y(k.deposits)})]})]})}),e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-orange-100 dark:bg-orange-900/20 rounded-lg",children:e.jsx(he,{className:"text-orange-600 dark:text-orange-400",size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Retraits"}),e.jsx("p",{className:"text-xl font-bold text-gray-900 dark:text-white",children:y(k.withdrawals)})]})]})})]}),e.jsxs(h,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"RÃ©partition par mode de paiement"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"EspÃ¨ces"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:y(B.cash)})]}),e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Mobile Money"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:y(B.mobile_money)})]}),e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Carte bancaire"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:y(B.card)})]})]})]}),e.jsxs(h,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Transactions du jour"}),w.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[e.jsx(K,{size:48,className:"mx-auto mb-3 opacity-30"}),e.jsx("p",{children:"Aucune transaction aujourd'hui"})]}):e.jsx("div",{className:"space-y-2",children:w.slice().reverse().map(p=>e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border border-gray-200 dark:border-gray-700 hover:border-[#f59e0b] transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[Z(p.type),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:J(p.type)}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:p.description})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`text-lg font-bold ${p.type==="sale"||p.type==="deposit"?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:[p.type==="sale"||p.type==="deposit"?"+":"-",y(p.amount)]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:ne(p.timestamp)})]})]},p.id))})]}),e.jsx(ue,{open:x,onOpenChange:i,title:"DÃ©pÃ´t de caisse",description:"Enregistrer un dÃ©pÃ´t d'argent en caisse",onSubmit:P,submitLabel:"Enregistrer le dÃ©pÃ´t",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(z,{htmlFor:"deposit-amount",children:"Montant (FCFA) *"}),e.jsx(V,{id:"deposit-amount",type:"number",value:a,onChange:p=>n(p.target.value),placeholder:"Ex: 50000",min:1})]}),e.jsxs("div",{children:[e.jsx(z,{htmlFor:"deposit-description",children:"Description"}),e.jsx(pe,{id:"deposit-description",value:l,onChange:p=>o(p.target.value),placeholder:"Ex: DÃ©pÃ´t initial de journÃ©e",rows:3})]})]})}),e.jsx(ue,{open:m,onOpenChange:r,title:"Retrait de caisse",description:"Enregistrer un retrait d'argent de la caisse",onSubmit:U,submitLabel:"Enregistrer le retrait",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800",children:e.jsxs("p",{className:"text-sm text-yellow-800 dark:text-yellow-400",children:["Solde disponible: ",e.jsx("strong",{children:y(k.balance)})]})}),e.jsxs("div",{children:[e.jsx(z,{htmlFor:"withdrawal-amount",children:"Montant (FCFA) *"}),e.jsx(V,{id:"withdrawal-amount",type:"number",value:s,onChange:p=>d(p.target.value),placeholder:"Ex: 10000",min:1,max:k.balance})]}),e.jsxs("div",{children:[e.jsx(z,{htmlFor:"withdrawal-description",children:"Description"}),e.jsx(pe,{id:"withdrawal-description",value:j,onChange:p=>D(p.target.value),placeholder:"Ex: Remise en banque",rows:3})]})]})})]}):null}function $s(){const{trips:c,tickets:b}=$(),[g,x]=u.useState(""),[i,m]=u.useState(null),r=u.useMemo(()=>ss(c),[c]),a=u.useMemo(()=>{if(!g)return r;const s=g.toLowerCase();return r.filter(d=>d.departure.toLowerCase().includes(s)||d.arrival.toLowerCase().includes(s)||d.busNumber.toLowerCase().includes(s))},[r,g]),n=u.useMemo(()=>i?Ae(b,i.id).sort((s,d)=>s.seatNumber.toString().localeCompare(d.seatNumber.toString())).map(s=>({seatNumber:s.seatNumber,name:s.passengerName,phone:s.passengerPhone,ticketNumber:s.id.substring(0,12),paymentMethod:s.paymentMethod,soldBy:s.cashierName,salesChannel:s.salesChannel})):[],[i,b]),l=()=>{if(!i){N.error("Veuillez sÃ©lectionner un trajet");return}window.print(),N.success(`ðŸ“„ Impression de la liste pour ${i.departure} â†’ ${i.arrival}`)},o=()=>{if(!i){N.error("Veuillez sÃ©lectionner un trajet");return}N.info("ðŸ“¥ Export Excel - FonctionnalitÃ© Ã  venir")};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx(q,{}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Listes de Passagers"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Consultez et imprimez les listes de passagers pour les trajets Ã  venir"})]}),e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),e.jsx(V,{type:"text",placeholder:"Rechercher par trajet ou numÃ©ro de bus...",value:g,onChange:s=>x(s.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(A,{size:24}),"Trajets des prochaines 24h"]}),a.length===0?e.jsxs(h,{className:"p-12 text-center",children:[e.jsx(A,{size:48,className:"mx-auto mb-3 opacity-30 text-gray-400"}),e.jsx("p",{className:"text-lg text-gray-500 dark:text-gray-400",children:g?"Aucun trajet trouvÃ©":"Aucun trajet prÃ©vu dans les 24h"})]}):a.map(s=>{const d=Fe(s),j=oe(s),D=i?.id===s.id;return e.jsxs(h,{className:`p-4 cursor-pointer transition-all ${D?"border-[#f59e0b] bg-yellow-50 dark:bg-yellow-900/20":"hover:border-[#f59e0b]"}`,onClick:()=>m(s),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-lg text-gray-900 dark:text-white",children:[s.departure," â†’ ",s.arrival]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Bus ",s.busNumber]})]}),e.jsx(R,{className:us(s.status).color,children:gs(s.status)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"DÃ©part"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:ne(s.departureTime)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Date"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:Ve(s.departureTime)})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Occupation"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${ps(j)}`}),e.jsxs("span",{className:"font-bold text-gray-900 dark:text-white",children:[d,"/",s.totalSeats]}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["(",ts(d,s.totalSeats),"%)"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Passagers"}),e.jsx("p",{className:"font-bold text-[#f59e0b]",children:d})]})]})]},s.id)})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Liste des Passagers"}),i&&n.length>0&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(S,{onClick:l,variant:"outline",size:"sm",children:[e.jsx(Be,{className:"mr-2",size:18}),"Imprimer"]}),e.jsxs(S,{onClick:o,variant:"outline",size:"sm",children:[e.jsx(ae,{className:"mr-2",size:18}),"Exporter"]})]})]}),i?n.length===0?e.jsxs(h,{className:"p-12 text-center",children:[e.jsx(A,{size:48,className:"mx-auto mb-3 opacity-30 text-gray-400"}),e.jsx("p",{className:"text-lg text-gray-500 dark:text-gray-400",children:"Aucun passager"}),e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"Ce trajet n'a pas encore de rÃ©servations"})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsx(h,{className:"p-4 bg-gradient-to-r from-[#f59e0b] to-[#d97706] text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm opacity-90",children:[i.departure," â†’ ",i.arrival]}),e.jsxs("p",{className:"font-bold text-xl",children:[n.length," passagers"]})]}),e.jsx(A,{size:32,className:"opacity-80"})]})}),e.jsx("div",{className:"space-y-2",children:n.map((s,d)=>e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"bg-[#f59e0b] text-white w-10 h-10 rounded-lg flex items-center justify-center font-bold",children:s.seatNumber}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-900 dark:text-white",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:s.phone})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:js(s.salesChannel)}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:X(s.paymentMethod)})]})]})},d))})]}):e.jsxs(h,{className:"p-12 text-center",children:[e.jsx(A,{size:48,className:"mx-auto mb-3 opacity-30 text-gray-400"}),e.jsx("p",{className:"text-lg text-gray-500 dark:text-gray-400",children:"SÃ©lectionnez un trajet"}),e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"Cliquez sur un trajet pour voir la liste des passagers"})]})]})]})]})}function Bs(){const{user:c}=O(),{tickets:b,refundTicket:g}=$(),[x,i]=u.useState(""),[m,r]=u.useState(new Set),a=u.useMemo(()=>{const s=ie(),d=b.filter(j=>j.status!=="valid"||j.cashierId!==c?.id?!1:(new Date(j.departureTime).getTime()-s.getTime())/(1e3*60*60)>=2);return Pe(d,"purchaseDate","desc")},[b,c?.id]),n=u.useMemo(()=>{if(!x)return a;const s=x.toLowerCase();return a.filter(d=>d.passengerName.toLowerCase().includes(s)||d.passengerPhone.includes(s)||d.id.toLowerCase().includes(s)||d.departure.toLowerCase().includes(s)||d.arrival.toLowerCase().includes(s))},[a,x]),l=s=>{const d=new Set(m);d.has(s.id)?d.delete(s.id):d.add(s.id),r(d)},o=()=>{if(m.size===0){N.error("Veuillez sÃ©lectionner au moins un billet Ã  rembourser");return}const s=b.filter(j=>m.has(j.id)),d=le(s);confirm(`Confirmer le remboursement de ${y(d)} ?`)&&(m.forEach(j=>g(j)),N.success(`Billets remboursÃ©s avec succÃ¨s!
${y(d)} remboursÃ©s`,{duration:5e3}),r(new Set))};return c?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx(q,{}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Remboursements"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"GÃ©rez les remboursements de billets"})]}),e.jsx(h,{className:"p-4 bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(bs,{className:"text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5",size:20}),e.jsxs("div",{className:"text-sm text-blue-800 dark:text-blue-400",children:[e.jsx("p",{className:"font-medium mb-1",children:"Politique de remboursement"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Seuls vos propres billets peuvent Ãªtre remboursÃ©s"}),e.jsx("li",{children:"Les billets doivent Ãªtre valides et non utilisÃ©s"}),e.jsx("li",{children:"Le dÃ©part ne doit pas avoir eu lieu"}),e.jsx("li",{children:"Le remboursement sera dÃ©duit de votre caisse"})]})]})]})}),e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),e.jsx(V,{type:"text",placeholder:"Rechercher par nom, tÃ©lÃ©phone, ID billet, trajet...",value:x,onChange:s=>i(s.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Billets remboursables"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a.length})]}),e.jsx(ys,{className:"text-green-600 dark:text-green-400",size:32})]})}),e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Montant total"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:y(le(a))})]}),e.jsx(De,{className:"text-blue-600 dark:text-blue-400",size:32})]})})]}),e.jsx("div",{className:"space-y-3",children:n.length===0?e.jsxs(h,{className:"p-12 text-center",children:[e.jsx(Ns,{size:48,className:"mx-auto mb-3 opacity-30 text-gray-400"}),e.jsx("p",{className:"text-lg text-gray-500 dark:text-gray-400",children:x?"Aucun billet trouvÃ©":"Aucun billet remboursable"}),e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:x?"Essayez une autre recherche":"Tous vos billets ont Ã©tÃ© utilisÃ©s ou remboursÃ©s"})]}):n.map(s=>e.jsxs(h,{className:"p-6 hover:border-[#f59e0b] transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"font-bold text-gray-900 dark:text-white",children:s.passengerName}),e.jsx(R,{className:"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400",children:"Valide"})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:s.passengerPhone})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl font-bold text-[#f59e0b]",children:y(s.price)}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:X(s.paymentMethod)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Trajet"}),e.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[s.departure," â†’ ",s.arrival]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"DÃ©part"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:E(s.departureTime)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"SiÃ¨ge"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:s.seatNumber})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Date d'achat"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:Ve(s.purchaseDate)})]})]}),e.jsx("div",{className:"flex gap-2 pt-4 border-t border-gray-200 dark:border-gray-700",children:e.jsxs(S,{onClick:()=>l(s),className:"flex-1 bg-red-600 hover:bg-red-700",children:[e.jsx(De,{className:"mr-2",size:18}),"Rembourser ce billet"]})})]},s.id))}),e.jsx(ue,{open:m.size>0,onOpenChange:()=>r(new Set),title:"Confirmer le remboursement",description:"VÃ©rifiez les informations avant de procÃ©der au remboursement",onSubmit:o,submitLabel:"Confirmer le remboursement",children:m.size>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800",children:e.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-400",children:"âš ï¸ Cette action est irrÃ©versible. Le montant sera dÃ©duit de votre caisse."})}),e.jsx("div",{className:"space-y-3 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:Array.from(m).map(s=>{const d=b.find(j=>j.id===s);return d?e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Passager:"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:d.passengerName})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Trajet:"}),e.jsxs("span",{className:"font-semibold text-gray-900 dark:text-white",children:[d.departure," â†’ ",d.arrival]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"SiÃ¨ge:"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:d.seatNumber})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Mode de paiement:"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:X(d.paymentMethod)})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold pt-3 border-t border-gray-200 dark:border-gray-600",children:[e.jsx("span",{className:"text-gray-900 dark:text-white",children:"Montant Ã  rembourser:"}),e.jsx("span",{className:"text-red-600 dark:text-red-400",children:y(d.price)})]})]},s):null})})]})})]}):null}const Es=c=>{switch(c){case"today":return"aujourd'hui";case"week":return"des 7 derniers jours";case"month":return"des 30 derniers jours"}};function Os(){const{user:c}=O(),{cashTransactions:b}=$(),[g,x]=u.useState("today"),i=u.useMemo(()=>{let n;return g==="today"?n=as():g==="week"?n=ve(7):n=ve(30),b.filter(l=>new Date(l.timestamp)>=n&&l.status==="completed").sort((l,o)=>new Date(o.timestamp).getTime()-new Date(l.timestamp).getTime())},[b,g]),m=u.useMemo(()=>{const n=Re(i),l=Ie(i),o=Le(i),s=rs(i);return{sales:{count:o.salesCount,amount:n},refunds:{count:o.refundsCount,amount:l},deposits:{count:o.depositsCount,amount:o.deposits},withdrawals:{count:o.withdrawalsCount,amount:o.withdrawals},netRevenue:s}},[i]),r=n=>{const l={sale:{label:J(n),icon:_,color:"bg-green-100 dark:bg-green-900/20",iconColor:"text-green-600 dark:text-green-400"},refund:{label:J(n),icon:de,color:"bg-red-100 dark:bg-red-900/20",iconColor:"text-red-600 dark:text-red-400"},deposit:{label:J(n),icon:te,color:"bg-blue-100 dark:bg-blue-900/20",iconColor:"text-blue-600 dark:text-blue-400"},withdrawal:{label:J(n),icon:te,color:"bg-orange-100 dark:bg-orange-900/20",iconColor:"text-orange-600 dark:text-orange-400"}};return l[n]||l.sale},a=()=>{const l=`Date,Type,Description,Mode de paiement,Montant,Sens
${i.map(j=>{const D=r(j.type);return[E(j.timestamp),D.label,j.description,X(j.method),j.amount,j.type==="sale"||j.type==="deposit"?"+":"-"].join(",")}).join(`
`)}`,o=new Blob([l],{type:"text/csv;charset=utf-8;"}),s=window.URL.createObjectURL(o),d=document.createElement("a");d.href=s,d.download=`historique-${g}-${new Date().toISOString().split("T")[0]}.csv`,d.click(),window.URL.revokeObjectURL(s),N.success("Historique exportÃ© avec succÃ¨s")};return c?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx(q,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Historique des Transactions"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Consultez l'historique de vos opÃ©rations"})]}),e.jsxs(S,{onClick:a,variant:"outline",disabled:i.length===0,children:[e.jsx(ke,{className:"mr-2",size:18}),"Exporter"]})]}),e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ps,{size:20,className:"text-gray-500 dark:text-gray-400"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:"PÃ©riode:"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{size:"sm",variant:g==="today"?"default":"outline",onClick:()=>x("today"),className:g==="today"?"bg-[#f59e0b] hover:bg-[#d97706]":"",children:"Aujourd'hui"}),e.jsx(S,{size:"sm",variant:g==="week"?"default":"outline",onClick:()=>x("week"),className:g==="week"?"bg-[#f59e0b] hover:bg-[#d97706]":"",children:"7 jours"}),e.jsx(S,{size:"sm",variant:g==="month"?"default":"outline",onClick:()=>x("month"),className:g==="month"?"bg-[#f59e0b] hover:bg-[#d97706]":"",children:"30 jours"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/20 rounded-lg",children:e.jsx(_,{className:"text-green-600 dark:text-green-400",size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Ventes"}),e.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:m.sales.count}),e.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400",children:["+",y(m.sales.amount)]})]})]})}),e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-100 dark:bg-red-900/20 rounded-lg",children:e.jsx(de,{className:"text-red-600 dark:text-red-400",size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Remboursements"}),e.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:m.refunds.count}),e.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400",children:["-",y(m.refunds.amount)]})]})]})}),e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:e.jsx(te,{className:"text-blue-600 dark:text-blue-400",size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"DÃ©pÃ´ts"}),e.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:m.deposits.count}),e.jsxs("p",{className:"text-xs text-blue-600 dark:text-blue-400",children:["+",y(m.deposits.amount)]})]})]})}),e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-orange-100 dark:bg-orange-900/20 rounded-lg",children:e.jsx(te,{className:"text-orange-600 dark:text-orange-400",size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Retraits"}),e.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:m.withdrawals.count}),e.jsxs("p",{className:"text-xs text-orange-600 dark:text-orange-400",children:["-",y(m.withdrawals.amount)]})]})]})}),e.jsx(h,{className:"p-4 bg-gradient-to-br from-[#f59e0b] to-[#d97706]",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(K,{className:"text-white",size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-white/80",children:"RÃ©sultat net"}),e.jsx("p",{className:"text-lg font-bold text-white",children:i.length}),e.jsxs("p",{className:`text-xs font-medium ${m.netRevenue>=0?"text-white":"text-red-200"}`,children:[m.netRevenue>=0?"+":"",y(m.netRevenue)]})]})]})})]}),e.jsxs(h,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:["Transactions ",Es(g)]}),i.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[e.jsx(ke,{size:48,className:"mx-auto mb-3 opacity-30"}),e.jsx("p",{children:"Aucune transaction pour cette pÃ©riode"})]}):e.jsx("div",{className:"space-y-2",children:i.map(n=>{const l=r(n.type),o=l.icon,s=n.type==="sale"||n.type==="deposit";return e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border border-gray-200 dark:border-gray-700 hover:border-[#f59e0b] transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:`p-2 rounded-lg ${l.color.split(" ")[0]} dark:${l.color.split("dark:")[1]}`,children:e.jsx(o,{className:l.iconColor,size:20})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:l.label}),e.jsx(R,{className:l.color,children:X(n.method)})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:n.description})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`text-lg font-bold ${s?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:[s?"+":"-",y(n.amount)]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:E(n.timestamp)})]})]},n.id)})})]})]}):null}function qs(){const{user:c}=O(),{supportTickets:b,addSupportTicket:g}=$(),[x,i]=u.useState({subject:"",priority:"medium",category:"technical",description:""}),m=a=>{if(a.preventDefault(),!c){N.error("Erreur: utilisateur non connectÃ©");return}if(!x.subject.trim()){N.error("Veuillez entrer un sujet");return}if(!x.description.trim()){N.error("Veuillez entrer une description");return}g({subject:x.subject,description:x.description,category:x.category,priority:x.priority,status:"open",createdBy:c.id,createdByName:c.name}),N.success("âœ… Votre signalement a Ã©tÃ© envoyÃ© au manager de gare !"),i({subject:"",priority:"medium",category:"technical",description:""})},r=b.filter(a=>a.createdBy===c?.id);return c?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx(q,{}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Signaler un ProblÃ¨me"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Informez votre manager de tout problÃ¨me rencontrÃ©"})]}),e.jsxs(h,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-[#dc2626] via-[#f59e0b] to-[#16a34a] rounded-full flex items-center justify-center",children:e.jsx(fs,{className:"text-white",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Nouveau signalement"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"DÃ©crivez le problÃ¨me rencontrÃ© pour obtenir de l'aide"})]})]}),e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(z,{htmlFor:"category",children:"CatÃ©gorie"}),e.jsxs(we,{value:x.category,onValueChange:a=>i({...x,category:a}),children:[e.jsx(Ce,{children:e.jsx(Se,{})}),e.jsxs(Te,{children:[e.jsx(L,{value:"technical",children:"ðŸ”§ Technique"}),e.jsx(L,{value:"financial",children:"ðŸ’° Financier"}),e.jsx(L,{value:"operational",children:"ðŸ“‹ OpÃ©rationnel"}),e.jsx(L,{value:"other",children:"ðŸ’¬ Autre"})]})]})]}),e.jsxs("div",{children:[e.jsx(z,{htmlFor:"priority",children:"PrioritÃ©"}),e.jsxs(we,{value:x.priority,onValueChange:a=>i({...x,priority:a}),children:[e.jsx(Ce,{children:e.jsx(Se,{})}),e.jsxs(Te,{children:[e.jsx(L,{value:"low",children:"Basse"}),e.jsx(L,{value:"medium",children:"Moyenne"}),e.jsx(L,{value:"high",children:"Haute"}),e.jsx(L,{value:"urgent",children:"Urgente"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(z,{htmlFor:"subject",children:"Sujet *"}),e.jsx(V,{id:"subject",type:"text",placeholder:"RÃ©sumez le problÃ¨me en quelques mots...",value:x.subject,onChange:a=>i({...x,subject:a.target.value})})]}),e.jsxs("div",{children:[e.jsx(z,{htmlFor:"description",children:"Description *"}),e.jsx(pe,{id:"description",placeholder:"DÃ©crivez le problÃ¨me en dÃ©tail : quand est-il survenu, quelles sont les consÃ©quences, etc.",value:x.description,onChange:a=>i({...x,description:a.target.value}),rows:6})]}),e.jsxs(S,{type:"submit",className:"w-full bg-gradient-to-r from-[#dc2626] via-[#f59e0b] to-[#16a34a]",children:[e.jsx(vs,{size:16,className:"mr-2"}),"Envoyer le signalement"]})]})]}),e.jsxs(h,{className:"p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:["Mes signalements (",r.length,")"]}),r.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[e.jsx(ks,{size:48,className:"mx-auto mb-3 opacity-30"}),e.jsx("p",{className:"text-lg",children:"Aucun signalement pour le moment"}),e.jsx("p",{className:"text-sm",children:"Vos signalements apparaÃ®tront ici une fois envoyÃ©s"})]}):e.jsx("div",{className:"space-y-3",children:r.sort((a,n)=>new Date(n.createdAt).getTime()-new Date(a.createdAt).getTime()).map(a=>e.jsx(h,{className:"p-4",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xl",children:ws(a.category)}),e.jsx("h3",{className:"font-bold text-gray-900 dark:text-white",children:a.subject}),e.jsx(R,{className:Ss(a.status),children:Cs(a.status)}),e.jsx(R,{className:Ds(a.priority),children:Ts(a.priority)})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-2",children:a.description}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("span",{children:["ðŸ“… ",E(a.createdAt)]}),a.messages&&a.messages.length>0&&e.jsxs("span",{children:["ðŸ’¬ ",a.messages.length," rÃ©ponse(s)"]})]}),a.messages&&a.messages.length>0&&e.jsx("div",{className:"mt-3 pl-4 border-l-2 border-blue-500",children:a.messages.map(n=>e.jsxs("div",{className:"mb-2 p-2 bg-blue-50 dark:bg-blue-900/20 rounded",children:[e.jsx("p",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100",children:n.userName}),e.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:n.message}),e.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:E(n.timestamp)})]},n.id))})]})})},a.id))})]})]}):null}function Us(){const{user:c}=O(),{trips:b,tickets:g}=$(),x=new Date,i=new Date(x.getTime()+1440*60*1e3),m=b.filter(r=>{const a=new Date(r.departureTime);return a>=x&&a<=i&&(r.status==="scheduled"||r.status==="boarding")});return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx(q,{}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl text-gray-900 dark:text-white mb-2",children:"Diagnostic des DonnÃ©es"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"VÃ©rification de la cohÃ©rence des donnÃ©es mockÃ©es"})]}),e.jsxs(h,{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:"ðŸ” Informations Utilisateur"}),e.jsxs("div",{className:"space-y-2 font-mono text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ID:"})," ",c?.id]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Nom:"})," ",c?.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Role:"})," ",c?.role]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Gare ID:"})," ",c?.gareId]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Gare:"})," ",c?.gareName]})]})]}),e.jsxs(h,{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:"ðŸ“… Date Actuelle (RÃ©elle)"}),e.jsxs("div",{className:"space-y-2 font-mono text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Date actuelle:"})," ",x.toISOString()]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Heure locale:"})," ",x.toLocaleString("fr-FR")]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Date + 24h:"})," ",i.toISOString()]})]})]}),e.jsxs(h,{className:"p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:["ðŸšŒ Tous les Trips FiltrÃ©s (par gareId=",c?.gareId,")"]}),e.jsxs("p",{className:"mb-4 text-gray-600",children:["Total: ",b.length," trips"]}),e.jsx("div",{className:"space-y-3",children:b.length===0?e.jsx("p",{className:"text-red-500",children:"âŒ Aucun trip trouvÃ© pour cette gare !"}):b.map(r=>{const a=new Date(r.departureTime),n=a>=x&&a<=i,l=r.status==="scheduled"||r.status==="boarding";return e.jsxs("div",{className:`p-3 rounded border ${n&&l?"bg-green-50 border-green-500":"bg-gray-50 border-gray-300"}`,children:[e.jsx("p",{className:"font-bold",children:r.id}),e.jsxs("p",{children:[e.jsx("strong",{children:"Route:"})," ",r.departure," â†’ ",r.arrival]}),e.jsxs("p",{children:[e.jsx("strong",{children:"DÃ©part:"})," ",a.toLocaleString()]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",r.status]}),e.jsxs("p",{children:[e.jsx("strong",{children:"SiÃ¨ges:"})," ",r.availableSeats,"/",r.totalSeats]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Gare:"})," ",r.gareId," (",r.gareName,")"]}),e.jsx("p",{className:n?"text-green-600":"text-red-600",children:n?"âœ… Dans les 24h":"âŒ Hors 24h"}),e.jsx("p",{className:l?"text-green-600":"text-orange-600",children:l?"âœ… Upcoming (scheduled/boarding)":"âŒ Pas upcoming ("+r.status+")"})]},r.id)})})]}),e.jsxs(h,{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:"âœ… Trips AffichÃ©s dans PassengerListsPage"}),e.jsxs("p",{className:"mb-4 text-gray-600",children:["Total: ",m.length," trips"]}),e.jsx("div",{className:"space-y-3",children:m.length===0?e.jsx("p",{className:"text-red-500",children:"âŒ Aucun trip dans les 24h avec status scheduled/boarding !"}):m.map(r=>{const a=Fe(r),n=oe(r);return e.jsxs("div",{className:"p-3 rounded bg-green-50 border border-green-500",children:[e.jsx("p",{className:"font-bold",children:r.id}),e.jsxs("p",{children:[e.jsx("strong",{children:"Route:"})," ",r.departure," â†’ ",r.arrival]}),e.jsxs("p",{children:[e.jsx("strong",{children:"DÃ©part:"})," ",new Date(r.departureTime).toLocaleString()]}),e.jsxs("p",{children:[e.jsx("strong",{children:"SiÃ¨ges vendus:"})," ",a,"/",r.totalSeats," (",n,"%)"]})]},r.id)})})]}),e.jsxs(h,{className:"p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:["ðŸŽ« Tickets FiltrÃ©s (par gareId=",c?.gareId,")"]}),e.jsxs("p",{className:"mb-4 text-gray-600",children:["Total: ",g.length," tickets"]}),e.jsx("div",{className:"space-y-2 font-mono text-sm max-h-96 overflow-y-auto",children:g.length===0?e.jsx("p",{className:"text-red-500",children:"âŒ Aucun ticket trouvÃ© pour cette gare !"}):e.jsxs("div",{className:"space-y-1",children:[g.slice(0,20).map(r=>e.jsx("div",{className:"p-2 bg-gray-50 rounded text-xs",children:e.jsxs("p",{children:[e.jsxs("strong",{children:[r.id,":"]})," Trip ",r.tripId," | ",r.passengerName," | SiÃ¨ge ",r.seatNumber]})},r.id)),g.length>20&&e.jsxs("p",{className:"text-gray-500",children:["... et ",g.length-20," autres tickets"]})]})})]})]})}function Ws(){return e.jsxs(ls,{children:[e.jsx(I,{path:"/",element:e.jsx(F,{role:"caissier",title:"Dashboard Caissier",children:e.jsx(Ls,{})})}),e.jsx(I,{path:"/vente",element:e.jsx(F,{role:"caissier",title:"Vente de Billets",children:e.jsx(Fs,{})})}),e.jsx(I,{path:"/caisse",element:e.jsx(F,{role:"caissier",title:"Gestion de Caisse",children:e.jsx(Vs,{})})}),e.jsx(I,{path:"/listes",element:e.jsx(F,{role:"caissier",title:"Listes Passagers",children:e.jsx($s,{})})}),e.jsx(I,{path:"/annulation",element:e.jsx(F,{role:"caissier",title:"Annulation Billets",children:e.jsx(Bs,{})})}),e.jsx(I,{path:"/historique",element:e.jsx(F,{role:"caissier",title:"Mon Historique",children:e.jsx(Os,{})})}),e.jsx(I,{path:"/signalement",element:e.jsx(F,{role:"caissier",title:"Signaler un ProblÃ¨me",children:e.jsx(qs,{})})}),e.jsx(I,{path:"/diagnostic",element:e.jsx(F,{role:"caissier",title:"ðŸ” Diagnostic DonnÃ©es",children:e.jsx(Us,{})})})]})}export{Ws as default};
