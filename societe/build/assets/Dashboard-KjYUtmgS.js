import{c as Ve,u as xe,p as Y,r as m,E as R,x as le,F as fe,y as U,e as oe,B as _,j as e,b as ke,C as Q,G as $e,f as Z,H as ie,t as H,w as Ee,I as Re,J as Oe,m as E,K as we,N as qe,O as me,q as O,M as Ge,A as _e,D as V}from"./index-BY9tNBYj.js";import{W as q,u as He,j as Je,af as Ke,U as K,D as X,T as Ce,S as J,C as x,B as z,h as Ue,g as Qe,x as ee,M as ge,N as Xe,a1 as de,ag as Ye,ah as We,y as p,_ as ne,X as he,L as B,R as A,ai as Se,aj as Ze,z as ue,a0 as es,a2 as ss,a3 as ts,a4 as as,A as Te,E as ze,F as De,G as Ae,H as Pe,Y as rs,V as ls,a7 as is,ak as pe,a8 as ds,a9 as ns,aa as cs,m as xs,ab as os,ac as ms,ad as gs,I as je,J as ye,K as be,O as Ne,Q as F,ae as $}from"./useFilteredData-CPVRhlNB.js";import{P as ce,E as re,c as W,a as hs,T as us,S as ps,b as js,d as ys}from"./empty-state-Cbx0dolk.js";import{C as bs,P as ve}from"./printer-LnlBVi6Z.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]],vs=Ve("banknote",Ns);function fs(){const o=xe(),{user:b}=Y(),{cashiers:u,tickets:N,trips:y,cashTransactions:v}=q(),{todayRevenue:a,revenueChangeFormatted:l,revenueTrend:g}=He(N),{activeTripsCount:i,upcomingTrips:n}=Je(y,4),h=Ke(N),j=m.useMemo(()=>{const t=R(v,"timestamp"),c=new Set(t.map(f=>f.cashierId));return u.filter(f=>c.has(f.id)&&f.status==="active")},[u,v]),k=m.useMemo(()=>n.slice(0,4),[n]),w=m.useMemo(()=>{const t=R(N,"purchaseDate");return u.filter(c=>c.status==="active").map(c=>{const f=le(t.filter(r=>r.cashierId===c.id)),C=R(v.filter(r=>r.cashierId===c.id),"timestamp"),T=fe(C);return{...c,sales:f.length,revenue:U(f),cashBalance:T}}).sort((c,f)=>f.revenue-c.revenue)},[u,N,v]),s=[{title:"Caissiers Actifs",value:j.length.toString(),change:`sur ${u.filter(t=>t.status==="active").length}`,trend:"neutral",icon:K,color:"yellow",subtitle:"En service"},{title:"Revenus du Jour",value:oe(a,"K"),change:l,trend:g,icon:X,color:"green",subtitle:"FCFA"},{title:"DÃ©parts Actifs",value:i.toString(),change:"En cours",trend:"neutral",icon:_,color:"red",subtitle:"Trajets"},{title:"Billets Vendus",value:h.toString(),change:"Aujourd'hui",trend:"up",icon:Ce,color:"green",subtitle:"Transactions"}];return b?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:s.map((t,c)=>e.jsx(J,{...t},c))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(x,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Performance des Caissiers"}),e.jsx("button",{onClick:()=>o("/manager/caissiers"),className:"text-sm text-[#f59e0b] hover:text-[#d97706] font-medium",children:"Voir dÃ©tails"})]}),w.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[e.jsx(K,{size:48,className:"mx-auto mb-3 opacity-30"}),e.jsx("p",{children:"Aucun caissier actif"})]}):e.jsx("div",{className:"space-y-3",children:w.slice(0,4).map(t=>e.jsxs("div",{className:"p-4 rounded-lg border border-gray-200 dark:border-gray-700 hover:border-[#f59e0b] transition-colors",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:t.name}),e.jsx("div",{className:"flex items-center gap-2 mt-1",children:e.jsx(z,{className:t.sales>0?"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300",children:t.sales>0?"Actif":"Inactif"})})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-3 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Ventes"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:t.sales})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Caisse"}),e.jsx("p",{className:"font-semibold text-[#f59e0b]",children:oe(t.revenue,"K")})]})]})]},t.id))})]}),e.jsxs(x,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Prochains DÃ©parts"}),e.jsx("button",{onClick:()=>o("/manager/departs"),className:"text-sm text-[#f59e0b] hover:text-[#d97706] font-medium",children:"GÃ©rer"})]}),k.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[e.jsx(_,{size:48,className:"mx-auto mb-3 opacity-30"}),e.jsx("p",{children:"Aucun dÃ©part imminent"})]}):e.jsx("div",{className:"space-y-3",children:k.map(t=>{const c=ke(t);return e.jsxs("div",{className:"p-4 rounded-lg border border-gray-200 dark:border-gray-700 hover:border-[#f59e0b] transition-colors cursor-pointer",onClick:()=>o("/manager/departs"),children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[t.departure," â†’ ",t.arrival]}),e.jsx(z,{className:Qe(t.status).color,children:Ue(t.status)})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Q,{size:14}),e.jsx("span",{children:new Date(t.departureTime).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})})]}),e.jsxs("span",{children:["Bus ",t.busNumber]})]})]})}),e.jsxs("div",{className:"flex items-center justify-between text-sm mb-2",children:[e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[t.totalSeats-t.availableSeats,"/",t.totalSeats," places"]}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:[c.toFixed(0),"%"]})]}),e.jsx("div",{className:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full transition-all rounded-full",style:{width:`${c}%`,backgroundColor:c>=80?"#16a34a":c>=50?"#f59e0b":"#dc2626"}})})]},t.id)})})]})]}),e.jsxs(x,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Actions Rapides"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("button",{onClick:()=>o("/manager/departs"),className:"p-6 rounded-lg border-2 border-dashed border-gray-300 dark:border-gray-600 hover:border-[#f59e0b] hover:bg-[#f59e0b]/5 transition-all text-gray-900 dark:text-white",children:[e.jsx(_,{size:32,className:"mx-auto mb-3 text-[#f59e0b]"}),e.jsx("p",{className:"font-medium",children:"GÃ©rer les dÃ©parts"})]}),e.jsxs("button",{onClick:()=>o("/manager/caissiers"),className:"p-6 rounded-lg border-2 border-dashed border-gray-300 dark:border-gray-600 hover:border-[#16a34a] hover:bg-[#16a34a]/5 transition-all text-gray-900 dark:text-white",children:[e.jsx(K,{size:32,className:"mx-auto mb-3 text-[#16a34a]"}),e.jsx("p",{className:"font-medium",children:"GÃ©rer les caissiers"})]}),e.jsxs("button",{onClick:()=>o("/manager/ventes"),className:"p-6 rounded-lg border-2 border-dashed border-gray-300 dark:border-gray-600 hover:border-[#dc2626] hover:bg-[#dc2626]/5 transition-all text-gray-900 dark:text-white",children:[e.jsx(X,{size:32,className:"mx-auto mb-3 text-[#dc2626]"}),e.jsx("p",{className:"font-medium",children:"Superviser les ventes"})]})]})]})]}):null}function ks(){const{trips:o}=q(),b=m.useMemo(()=>$e(o,2).map(l=>{let g="at_station";if(l.status==="boarding")g="boarding";else if(l.status==="departed"){if(g="en_route",l.estimatedArrival){const i=new Date(l.estimatedArrival),n=new Date(l.arrivalTime);i>n&&(g="delayed")}}else l.status==="scheduled"&&(g="at_station");return{id:l.id,route:`${l.departure} â†’ ${l.arrival}`,busNumber:l.busNumber||"N/A",status:g,departureTime:Z(l.departureTime),passengers:ie(l),capacity:l.totalSeats,location:l.currentLocation?`GPS: ${l.currentLocation.lat.toFixed(4)}, ${l.currentLocation.lng.toFixed(4)}`:g==="en_route"?"En route":l.gareName,eta:l.estimatedArrival?Z(l.estimatedArrival):void 0,gpsPosition:l.currentLocation}}),[o]),u=b.filter(a=>a.status==="at_station"||a.status==="boarding"),N=b.filter(a=>a.status==="en_route"),y=b.filter(a=>a.status==="delayed"),v=b.reduce((a,l)=>a+l.passengers,0);return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx(ee,{}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Suivi des Trajets Locaux"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Suivez en temps rÃ©el les trajets partant de votre gare"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Ã€ la gare"}),e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:u.length})]}),e.jsx("div",{className:"w-12 h-12 bg-green-100 dark:bg-green-900/20 rounded-full flex items-center justify-center",children:e.jsx(ge,{className:"text-green-600 dark:text-green-400",size:24})})]})}),e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"En route"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:N.length})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900/20 rounded-full flex items-center justify-center",children:e.jsx(Xe,{className:"text-blue-600 dark:text-blue-400",size:24})})]})}),e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"RetardÃ©s"}),e.jsx("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:y.length})]}),e.jsx("div",{className:"w-12 h-12 bg-red-100 dark:bg-red-900/20 rounded-full flex items-center justify-center",children:e.jsx(de,{className:"text-red-600 dark:text-red-400",size:24})})]})}),e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total passagers"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:v})]}),e.jsx("div",{className:"w-12 h-12 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center",children:e.jsx(_,{className:"text-gray-600 dark:text-gray-400",size:24})})]})})]}),e.jsxs(x,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Carte temps rÃ©el"}),e.jsx(z,{className:"bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-400",children:"ðŸ—ºï¸ Google Maps - Ã€ intÃ©grer"})]}),e.jsx("div",{className:"relative h-96 bg-gray-100 dark:bg-gray-800 rounded-lg overflow-hidden flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ge,{className:"mx-auto mb-4 text-gray-400 dark:text-gray-600",size:64}),e.jsx("p",{className:"text-lg font-semibold text-gray-600 dark:text-gray-400 mb-2",children:"Carte Google Maps"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mb-1",children:"En attente de l'intÃ©gration de l'API"}),e.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-600",children:"Position des trajets = agrÃ©gation GPS des passagers"})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Tous les trajets en cours"}),b.length===0?e.jsxs(x,{className:"p-8 text-center",children:[e.jsx(Q,{className:"mx-auto mb-4 text-gray-400",size:48}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Aucun trajet en cours ou Ã  venir dans les 2 prochaines heures"})]}):b.map(a=>e.jsx(x,{className:"p-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-bold text-gray-900 dark:text-white",children:a.route}),e.jsx(z,{className:We(a.status),children:Ye(a.status)})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Bus"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:a.busNumber})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"DÃ©part"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:a.departureTime})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Position"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-white text-xs",children:a.location})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Passagers"}),e.jsxs("p",{className:"font-medium text-green-600 dark:text-green-400",children:[a.passengers,"/",a.capacity]})]}),a.eta&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"ETA"}),e.jsx("p",{className:"font-medium text-blue-600 dark:text-blue-400",children:a.eta})]})]})]})})},a.id))]})]})}function ws(){const{cashiers:o,tickets:b,cashTransactions:u,addCashier:N,updateCashier:y,deleteCashier:v}=q(),[a,l]=m.useState(!1),[g,i]=m.useState(!1),[n,h]=m.useState(null),[j,k]=m.useState(!1),[w,s]=m.useState({}),[t,c]=m.useState({name:"",email:"",phone:"",password:""}),f=m.useMemo(()=>R(b,"purchaseDate").filter(d=>d.status==="valid"||d.status==="used"),[b]),C=U(f),T=f.length,r=m.useMemo(()=>{const d=R(u,"timestamp"),D=new Set(d.map(I=>I.cashierId));return o.filter(I=>D.has(I.id)&&I.status==="active")},[o,u]),S=d=>{const D=f.filter(G=>G.cashierId===d),I=U(D),ae=D.length,M=D.length>0?D.sort((G,Le)=>new Date(Le.purchaseDate).getTime()-new Date(G.purchaseDate).getTime())[0]:null,Me=M?new Date(M.purchaseDate).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}):"Aucune vente",Be=R(u,"timestamp").filter(G=>G.cashierId===d&&G.status==="completed"),Fe=fe(Be);return{sales:I,ticketsSold:ae,lastActivity:Me,cashBalance:Fe}},P=()=>{N(t),l(!1),c({name:"",email:"",phone:"",password:""}),H.success("Caissier ajoutÃ© avec succÃ¨s")},L=()=>{n&&(y(n.id,t),i(!1),c({name:"",email:"",phone:"",password:""}),H.success("Caissier modifiÃ© avec succÃ¨s"))},se=d=>{v(d),H.success("Caissier supprimÃ© avec succÃ¨s")},te=d=>{h(d),c({name:d.name,email:d.email,phone:d.phone,password:""}),i(!0)},Ie=d=>{s(D=>({...D,[d]:!D[d]}))};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx(ee,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Gestion des Caissiers"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Supervision en temps rÃ©el de votre Ã©quipe"})]}),e.jsxs(p,{onClick:()=>l(!0),className:"bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(ce,{className:"mr-2",size:20}),"Nouveau caissier"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Caissiers actifs"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:[r.length,"/",o.length]})]}),e.jsx("div",{className:"w-12 h-12 bg-green-100 dark:bg-green-900/20 rounded-full flex items-center justify-center",children:e.jsx(ne,{className:"text-green-600 dark:text-green-400",size:24})})]})}),e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Ventes totales"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:C.toLocaleString()})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900/20 rounded-full flex items-center justify-center",children:e.jsx(X,{className:"text-blue-600 dark:text-blue-400",size:24})})]})}),e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Billets vendus"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:T})]}),e.jsx("div",{className:"w-12 h-12 bg-purple-100 dark:bg-purple-900/20 rounded-full flex items-center justify-center",children:e.jsx(Ce,{className:"text-purple-600 dark:text-purple-400",size:24})})]})}),e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Panier moyen"}),e.jsx("p",{className:"text-2xl font-bold text-[#f59e0b]",children:T>0?Math.round(C/T).toLocaleString():0})]}),e.jsx("div",{className:"w-12 h-12 bg-yellow-100 dark:bg-yellow-900/20 rounded-full flex items-center justify-center",children:e.jsx(X,{className:"text-[#f59e0b]",size:24})})]})})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:o.map(d=>{const{sales:D,ticketsSold:I,lastActivity:ae}=S(d.id);return e.jsx(x,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-[#dc2626] via-[#f59e0b] to-[#16a34a] rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-white text-xl font-bold",children:d.name.split(" ").map(M=>M[0]).join("")})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-900 dark:text-white",children:d.name}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["DerniÃ¨re activitÃ©: ",ae]})]}),e.jsx(z,{className:r.some(M=>M.id===d.id)?"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300",children:r.some(M=>M.id===d.id)?"ðŸŸ¢ Caisse ouverte":"âšª Caisse fermÃ©e"})]}),e.jsxs("div",{className:"mb-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"ðŸ” Identifiants de connexion"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Email:"}),e.jsx("p",{className:"text-xs font-medium text-gray-900 dark:text-white",children:d.email})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Mot de passe:"}),e.jsx("p",{className:"text-xs font-mono font-medium text-gray-900 dark:text-white",children:w[d.id]?d.password:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"}),e.jsx("button",{onClick:()=>Ie(d.id),className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded",children:w[d.id]?e.jsx(re,{size:14,className:"text-gray-600 dark:text-gray-400"}):e.jsx(W,{size:14,className:"text-gray-600 dark:text-gray-400"})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Ventes du jour"}),e.jsxs("p",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:[D.toLocaleString()," FCFA"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Billets vendus"}),e.jsx("p",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:I})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(p,{onClick:()=>te(d),className:"bg-[#f59e0b] hover:bg-[#d97706]",children:[e.jsx(hs,{className:"mr-2",size:20}),"Modifier"]}),e.jsxs(p,{onClick:()=>se(d.id),className:"bg-red-500 hover:bg-red-600",children:[e.jsx(us,{className:"mr-2",size:20}),"Supprimer"]})]})]})]})},d.id)})}),e.jsx(he,{open:a,onOpenChange:l,title:"Ajouter un nouveau caissier",onSubmit:P,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"name",children:"Nom *"}),e.jsx(A,{id:"name",value:t.name,onChange:d=>c({...t,name:d.target.value}),placeholder:"Nom complet du caissier"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"email",children:"Email *"}),e.jsx(A,{id:"email",type:"email",value:t.email,onChange:d=>c({...t,email:d.target.value}),placeholder:"caissier@exemple.com"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"phone",children:"TÃ©lÃ©phone *"}),e.jsx(A,{id:"phone",value:t.phone,onChange:d=>c({...t,phone:d.target.value}),placeholder:"+226 70 12 34 56"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"password",children:"Mot de passe * (min. 6 caractÃ¨res)"}),e.jsxs("div",{className:"relative",children:[e.jsx(A,{id:"password",type:j?"text":"password",value:t.password,onChange:d=>c({...t,password:d.target.value}),placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"}),e.jsx("button",{type:"button",onClick:()=>k(!j),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:j?e.jsx(re,{size:18}):e.jsx(W,{size:18})})]})]})]})}),e.jsx(he,{open:g,onOpenChange:i,title:"Modifier le caissier",onSubmit:L,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-name",children:"Nom *"}),e.jsx(A,{id:"edit-name",value:t.name,onChange:d=>c({...t,name:d.target.value}),placeholder:"Nom complet du caissier"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-email",children:"Email *"}),e.jsx(A,{id:"edit-email",type:"email",value:t.email,onChange:d=>c({...t,email:d.target.value}),placeholder:"caissier@exemple.com"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-phone",children:"TÃ©lÃ©phone *"}),e.jsx(A,{id:"edit-phone",value:t.phone,onChange:d=>c({...t,phone:d.target.value}),placeholder:"+226 70 12 34 56"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-password",children:"Nouveau mot de passe (optionnel, min. 6 caractÃ¨res)"}),e.jsxs("div",{className:"relative",children:[e.jsx(A,{id:"edit-password",type:j?"text":"password",value:t.password,onChange:d=>c({...t,password:d.target.value}),placeholder:"Laisser vide pour ne pas changer"}),e.jsx("button",{type:"button",onClick:()=>k(!j),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:j?e.jsx(re,{size:18}):e.jsx(W,{size:18})})]})]})]})})]})}function Cs(){const o=xe(),{user:b}=Y(),{tickets:u,cashiers:N}=q(),[y,v]=m.useState("today"),a=m.useMemo(()=>{switch(y){case"today":return R(u,"purchaseDate");case"yesterday":return Re(u,"purchaseDate");case"week":const i=Ee(7);return u.filter(n=>new Date(n.purchaseDate)>=i);default:return u}},[u,y]),l=m.useMemo(()=>{const i=le(a),n=U(i),h=Oe(i);return{totalSales:n,cashSales:h.cash,mobileSales:h.mobileMoney,cardSales:h.card,ticketCount:i.length}},[a]),g=m.useMemo(()=>{const i=new Map;return N.filter(n=>n.status==="active").forEach(n=>{const h=a.filter(w=>w.cashierId===n.id),j=le(h),k=U(j);i.set(n.id,{name:n.name,ticketCount:j.length,total:k})}),Array.from(i.values()).filter(n=>n.ticketCount>0).sort((n,h)=>h.total-n.total)},[N,a]);return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("button",{onClick:()=>o(-1),className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[e.jsx(Se,{size:20}),"Retour"]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Supervision des Ventes"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Consultation en lecture seule des ventes de tous les caissiers de ",b?.gareName||"la gare"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>v("today"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${y==="today"?"bg-gradient-to-r from-[#dc2626] via-[#f59e0b] to-[#16a34a] text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:"Aujourd'hui"}),e.jsx("button",{onClick:()=>v("yesterday"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${y==="yesterday"?"bg-gradient-to-r from-[#dc2626] via-[#f59e0b] to-[#16a34a] text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:"Hier"}),e.jsx("button",{onClick:()=>v("week"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${y==="week"?"bg-gradient-to-r from-[#dc2626] via-[#f59e0b] to-[#16a34a] text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:"Semaine"})]})]}),e.jsx(x,{className:"p-4 bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(W,{className:"text-blue-600 dark:text-blue-400 flex-shrink-0",size:24}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-blue-900 dark:text-blue-100 mb-1",children:"Mode consultation uniquement"}),e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:"Vous pouvez visualiser toutes les ventes mais vous ne pouvez pas les modifier ou les annuler. Seuls les caissiers peuvent annuler leurs propres ventes."})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(J,{title:"Total des ventes",value:E(l.totalSales),change:`${l.ticketCount} billets`,trend:"up",icon:X,color:"green"}),e.jsx(J,{title:"EspÃ¨ces",value:E(l.cashSales),change:"Paiement cash",trend:"neutral",icon:vs,color:"blue"}),e.jsx(J,{title:"Mobile Money",value:E(l.mobileSales),change:"Paiement mobile",trend:"neutral",icon:ps,color:"yellow"}),e.jsx(J,{title:"Carte bancaire",value:E(l.cardSales),change:"Paiement carte",trend:"neutral",icon:bs,color:"blue"})]}),e.jsxs(x,{className:"p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:["Historique des ventes (",a.length,")"]}),a.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[e.jsx(K,{size:48,className:"mx-auto mb-3 opacity-30"}),e.jsx("p",{className:"text-lg",children:"Aucune vente pour cette pÃ©riode"}),e.jsx("p",{className:"text-sm",children:"Les ventes apparaÃ®tront ici dÃ¨s qu'un caissier vendra un billet"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-900 dark:text-white",children:"NÂ° Ticket"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-900 dark:text-white",children:"Heure"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-900 dark:text-white",children:"Trajet"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-900 dark:text-white",children:"Client"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-900 dark:text-white",children:"SiÃ¨ge"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-900 dark:text-white",children:"Paiement"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-900 dark:text-white",children:"Montant"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-900 dark:text-white",children:"Vendu par"})]})}),e.jsx("tbody",{children:a.map(i=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-800 hover:bg-gray-50 dark:hover:bg-gray-800/50",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsxs("span",{className:"font-mono text-sm font-medium text-gray-900 dark:text-white",children:[i.id.substring(0,12),"..."]})}),e.jsx("td",{className:"py-3 px-4 text-gray-700 dark:text-gray-300",children:new Date(i.purchaseDate).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})}),e.jsxs("td",{className:"py-3 px-4 text-gray-700 dark:text-gray-300",children:[i.departure," - ",i.arrival]}),e.jsx("td",{className:"py-3 px-4 text-gray-700 dark:text-gray-300",children:i.passengerName}),e.jsx("td",{className:"py-3 px-4",children:e.jsx(z,{className:"bg-[#f59e0b] text-white",children:i.seatNumber})}),e.jsx("td",{className:"py-3 px-4",children:Ze(i.paymentMethod)}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"font-bold text-green-600 dark:text-green-400",children:E(i.price)})}),e.jsx("td",{className:"py-3 px-4 text-gray-700 dark:text-gray-300",children:i.cashierName})]},i.id))})]})})]}),e.jsxs(x,{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:"Performance par caissier"}),g.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:e.jsx("p",{children:"Aucun caissier n'a encore effectuÃ© de vente pour cette pÃ©riode"})}):e.jsx("div",{className:"space-y-3",children:g.map(i=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-[#dc2626] via-[#f59e0b] to-[#16a34a] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold",children:i.name.split(" ").map(n=>n[0]).join("")})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:i.name}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[i.ticketCount," billets vendus"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xl font-bold text-green-600 dark:text-green-400",children:E(i.total)}),l.totalSales>0&&e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[we(i.total,l.totalSales),"% du total"]})]})]},i.name))})]})]})}function Ss(){const{user:o}=Y(),{trips:b,tickets:u}=q(),[N,y]=m.useState(null),v=xe(),a=m.useMemo(()=>qe(b,"departureTime").filter(s=>s.gareId===o?.gareId).sort((s,t)=>new Date(s.departureTime).getTime()-new Date(t.departureTime).getTime()),[b,o?.gareId]),l=()=>{window.print()},g=s=>{const t=a.find(C=>C.id===s);if(!t)return;const c=me(u,s),f=`
      <div style="font-family: Arial, sans-serif; padding: 20px;">
        <h1 style="text-align: center; color: #333; margin-bottom: 30px;">ðŸšŒ Liste des Passagers</h1>
        <div style="margin: 20px 0;">
          <p style="margin: 10px 0;"><strong>Trajet :</strong> ${t.departure} â†’ ${t.arrival}</p>
          <p style="margin: 10px 0;"><strong>DÃ©part :</strong> ${O(t.departureTime)}</p>
          <p style="margin: 10px 0;"><strong>Bus :</strong> ${t.busNumber}</p>
          <p style="margin: 10px 0;"><strong>Passagers :</strong> ${c.length}/${t.totalSeats}</p>
        </div>
        <table style="width: 100%; border-collapse: collapse; margin-top: 20px;">
          <thead>
            <tr>
              <th style="border: 1px solid #ddd; padding: 10px; text-align: left; background-color: #f59e0b; color: white;">NÂ°</th>
              <th style="border: 1px solid #ddd; padding: 10px; text-align: left; background-color: #f59e0b; color: white;">SiÃ¨ge</th>
              <th style="border: 1px solid #ddd; padding: 10px; text-align: left; background-color: #f59e0b; color: white;">Nom du passager</th>
              <th style="border: 1px solid #ddd; padding: 10px; text-align: left; background-color: #f59e0b; color: white;">TÃ©lÃ©phone</th>
              <th style="border: 1px solid #ddd; padding: 10px; text-align: left; background-color: #f59e0b; color: white;">Prix</th>
            </tr>
          </thead>
          <tbody>
            ${c.map((C,T)=>`
              <tr style="${T%2===0?"background-color: #f9f9f9;":""}">
                <td style="border: 1px solid #ddd; padding: 10px;">${T+1}</td>
                <td style="border: 1px solid #ddd; padding: 10px;">${C.seatNumber}</td>
                <td style="border: 1px solid #ddd; padding: 10px;">${C.passengerName}</td>
                <td style="border: 1px solid #ddd; padding: 10px;">${C.passengerPhone}</td>
                <td style="border: 1px solid #ddd; padding: 10px;">${E(C.price)}</td>
              </tr>
            `).join("")}
          </tbody>
        </table>
        <div style="margin-top: 30px; text-align: center; font-size: 12px; color: #666;">
          <p>ImprimÃ© le ${O(new Date().toISOString())}</p>
          <p>FasoTravel Dashboard - ${t.gareName}</p>
        </div>
      </div>
    `;y(f),setTimeout(()=>{window.print(),y(null)},100)},i=s=>{const t={boarding:{label:"ðŸŸ¡ Embarquement",className:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/20 dark:text-yellow-400"},scheduled:{label:"ðŸ”µ ProgrammÃ©",className:"bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-400"},departed:{label:"âšª Parti",className:"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300"},arrived:{label:"ðŸŸ¢ ArrivÃ©",className:"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400"},cancelled:{label:"ðŸ”´ AnnulÃ©",className:"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400"}};return e.jsx(z,{className:t[s]?.className||t.scheduled.className,children:t[s]?.label||s})},n=m.useMemo(()=>a.filter(s=>s.status==="scheduled"||s.status==="boarding"),[a]),h=m.useMemo(()=>a.filter(s=>s.status==="departed"||s.status==="arrived"||s.status==="cancelled"),[a]),j=new Set(a.map(s=>s.id)),k=u.filter(s=>j.has(s.tripId)&&(s.status==="valid"||s.status==="used")).length,w=a.reduce((s,t)=>s+t.totalSeats,0);return e.jsxs("div",{className:"p-6 space-y-6",children:[N&&e.jsx("div",{className:"print:block hidden",dangerouslySetInnerHTML:{__html:N}}),e.jsxs("div",{className:"print:hidden",children:[e.jsxs(p,{variant:"outline",size:"sm",onClick:()=>v("/manager"),className:"mb-4",children:[e.jsx(Se,{size:16,className:"mr-2"}),"Retour"]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"DÃ©parts du Jour"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Supervision et impression des listes d'embarquement"})]}),e.jsxs(p,{onClick:l,className:"bg-[#f59e0b] hover:bg-[#d97706]",children:[e.jsx(ve,{size:16,className:"mr-2"}),"Tout imprimer"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"DÃ©parts Ã  venir"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:n.length})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900/20 rounded-full flex items-center justify-center",children:e.jsx(Q,{className:"text-blue-600 dark:text-blue-400",size:24})})]})}),e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Partis aujourd'hui"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:h.length})]}),e.jsx("div",{className:"w-12 h-12 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center",children:e.jsx(_,{className:"text-gray-600 dark:text-gray-400",size:24})})]})}),e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Passagers totaux"}),e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:k})]}),e.jsx("div",{className:"w-12 h-12 bg-green-100 dark:bg-green-900/20 rounded-full flex items-center justify-center",children:e.jsx(K,{className:"text-green-600 dark:text-green-400",size:24})})]})}),e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Taux de remplissage"}),e.jsxs("p",{className:"text-2xl font-bold text-[#f59e0b]",children:[w>0?Math.round(k/w*100):0,"%"]})]}),e.jsx("div",{className:"w-12 h-12 bg-yellow-100 dark:bg-yellow-900/20 rounded-full flex items-center justify-center",children:e.jsx(_,{className:"text-[#f59e0b]",size:24})})]})})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:"DÃ©parts Ã  venir"}),n.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-4",children:n.map(s=>{const t=ie(s),c=me(u,s.id);return e.jsx(x,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:[s.departure," â†’ ",s.arrival]}),i(s.status)]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Heure de dÃ©part"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:Z(s.departureTime)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"VÃ©hicule"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:s.busNumber})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Passagers"}),e.jsxs("p",{className:"font-semibold text-green-600 dark:text-green-400",children:[t,"/",s.totalSeats]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Taux"}),e.jsxs("p",{className:"font-semibold text-gray-900 dark:text-white",children:[we(t,s.totalSeats),"%"]})]})]}),e.jsx("div",{className:"mt-3",children:e.jsx("div",{className:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-[#dc2626] via-[#f59e0b] to-[#16a34a]",style:{width:`${ke(s)}%`}})})})]}),e.jsxs(p,{variant:"outline",size:"sm",onClick:()=>g(s.id),className:"ml-4",children:[e.jsx(ve,{size:16,className:"mr-2"}),"Imprimer (",c.length,")"]})]})},s.id)})}):e.jsxs(x,{className:"p-12 text-center",children:[e.jsx(Q,{className:"mx-auto text-gray-400 mb-4",size:48}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Aucun dÃ©part Ã  venir"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Tous les dÃ©parts d'aujourd'hui sont partis ou il n'y a pas de dÃ©part programmÃ©"})]})]}),h.length>0&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:"Partis aujourd'hui"}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:h.map(s=>{const t=ie(s);return e.jsx(x,{className:"p-4 bg-gray-50 dark:bg-gray-800/50",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsxs("h3",{className:"font-bold text-gray-900 dark:text-white",children:[s.departure," â†’ ",s.arrival]}),i(s.status)]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[Z(s.departureTime)," â€¢ ",s.busNumber," â€¢ ",t,"/",s.totalSeats," passagers"]})]})})},s.id)})})]})]})]})}function Ts(){const{incidents:o,trips:b,updateIncident:u}=q(),{user:N}=Y(),[y,v]=m.useState(""),[a,l]=m.useState(null),[g,i]=m.useState(null),[n,h]=m.useState(!1),[j,k]=m.useState(null),[w,s]=m.useState(""),c=o.map(r=>{const S=b.find(P=>P.id===r.tripId);return{...r,route:S?`${S.departure} - ${S.arrival}`:"N/A",departureTime:S?.departureTime||"",busNumber:S?.busNumber||"N/A"}}).filter(r=>{const S=r.title.toLowerCase().includes(y.toLowerCase())||r.description.toLowerCase().includes(y.toLowerCase())||r.route.toLowerCase().includes(y.toLowerCase()),P=a?r.type===a:!0,L=g?r.validationStatus===g:!0;return S&&P&&L}),f=r=>{k(r),h(!0),s("")},C=r=>{!j||!N||(u(j.id,{validationStatus:r,validatedBy:N.id,validatedByName:N.name,validatedAt:new Date().toISOString(),validationComment:w.trim()||void 0,status:r==="validated"?"in_progress":"closed"}),h(!1),k(null),s(""))},T={total:o.length,pending:o.filter(r=>r.validationStatus==="pending").length,validated:o.filter(r=>r.validationStatus==="validated").length,rejected:o.filter(r=>r.validationStatus==="rejected").length};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx(ee,{}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Incidents SignalÃ©s"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Consultez et validez les incidents signalÃ©s pour votre gare"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:T.total})]}),e.jsx(de,{className:"text-gray-400",size:32})]})}),e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"En attente"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:T.pending})]}),e.jsx(Q,{className:"text-orange-400",size:32})]})}),e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"ValidÃ©s"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:T.validated})]}),e.jsx(ne,{className:"text-green-400",size:32})]})}),e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"RejetÃ©s"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:T.rejected})]}),e.jsx(ue,{className:"text-red-400",size:32})]})})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(es,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-gray-400",size:20}),e.jsx(A,{placeholder:"Rechercher un incident...",value:y,onChange:r=>v(r.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{variant:g===null?"default":"outline",size:"sm",onClick:()=>i(null),className:g===null?"tf-btn-primary":"",children:"Tous les statuts"}),e.jsx(p,{variant:g==="pending"?"default":"outline",size:"sm",onClick:()=>i("pending"),className:g==="pending"?"tf-btn-primary":"",children:"En attente"}),e.jsx(p,{variant:g==="validated"?"default":"outline",size:"sm",onClick:()=>i("validated"),className:g==="validated"?"tf-btn-primary":"",children:"ValidÃ©s"}),e.jsx(p,{variant:g==="rejected"?"default":"outline",size:"sm",onClick:()=>i("rejected"),className:g==="rejected"?"tf-btn-primary":"",children:"RejetÃ©s"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{variant:a===null?"default":"outline",size:"sm",onClick:()=>l(null),className:a===null?"tf-btn-primary":"",children:"Tous les types"}),e.jsx(p,{variant:a==="delay"?"default":"outline",size:"sm",onClick:()=>l("delay"),className:a==="delay"?"tf-btn-primary":"",children:"Retards"}),e.jsx(p,{variant:a==="breakdown"?"default":"outline",size:"sm",onClick:()=>l("breakdown"),className:a==="breakdown"?"tf-btn-primary":"",children:"Pannes"}),e.jsx(p,{variant:a==="accident"?"default":"outline",size:"sm",onClick:()=>l("accident"),className:a==="accident"?"tf-btn-primary":"",children:"Accidents"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[c.map(r=>{const S=ss(r.type),P=ts(r.severity),L=as(r.validationStatus),se=S.icon,te=L.icon;return e.jsx(x,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:`p-2 rounded-lg ${S.color}`,children:e.jsx(se,{size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-900 dark:text-white",children:r.title}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[r.route," â€¢ Bus ",r.busNumber," â€¢ DÃ©part: ",O(r.departureTime)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(z,{className:S.color,children:S.label}),e.jsx(z,{className:P.color,children:P.label}),e.jsxs("div",{className:`flex items-center gap-1 ${L.color}`,children:[e.jsx(te,{size:16}),e.jsx("span",{className:"text-sm font-medium",children:L.label})]})]}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-3",children:r.description}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("span",{children:["SignalÃ© par: ",r.reportedBy]}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:O(r.reportedAt)})]}),r.validationStatus!=="pending"&&r.validatedByName&&e.jsxs("div",{className:"mt-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("p",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-1",children:[r.validationStatus==="validated"?"âœ… ValidÃ©":"âŒ RejetÃ©"," par ",r.validatedByName]}),r.validationComment&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:r.validationComment}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:O(r.validatedAt)})]})]}),r.validationStatus==="pending"&&e.jsx("div",{className:"ml-4",children:e.jsx(p,{size:"sm",className:"bg-blue-600 hover:bg-blue-700",onClick:()=>f(r),children:"Traiter"})})]})},r.id)}),c.length===0&&e.jsxs(x,{className:"p-12 text-center",children:[e.jsx(de,{size:48,className:"mx-auto mb-4 text-gray-300 dark:text-gray-600"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Aucun incident trouvÃ©"})]})]}),e.jsx(Te,{open:n,onOpenChange:h,children:e.jsxs(ze,{children:[e.jsxs(De,{children:[e.jsx(Ae,{children:"Valider l'incident"}),e.jsx(Pe,{children:"Confirmez-vous que cet incident est rÃ©el ? Cette action informera l'Ã©quipe admin FasoTravel."})]}),j&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white mb-1",children:j.title}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:j.description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Commentaire (optionnel)"}),e.jsx(rs,{placeholder:"Ajoutez des informations supplÃ©mentaires...",value:w,onChange:r=>s(r.target.value),rows:3})]})]}),e.jsxs(ls,{children:[e.jsx(p,{variant:"outline",onClick:()=>h(!1),children:"Annuler"}),e.jsxs(p,{variant:"outline",className:"bg-red-50 hover:bg-red-100 text-red-700 border-red-200",onClick:()=>C("rejected"),children:[e.jsx(ue,{size:16,className:"mr-2"}),"Rejeter"]}),e.jsxs(p,{className:"bg-green-600 hover:bg-green-700",onClick:()=>C("validated"),children:[e.jsx(ne,{size:16,className:"mr-2"}),"Valider"]})]})]})})]})}function zs(){const{user:o}=Y(),{supportTickets:b,addSupportTicket:u,addSupportMessage:N}=q(),[y,v]=m.useState(null),[a,l]=m.useState(""),[g,i]=m.useState(!1),[n,h]=m.useState({subject:"",description:"",category:"operational",priority:"medium"}),j=b.sort((s,t)=>new Date(t.createdAt).getTime()-new Date(s.createdAt).getTime()),k=()=>{if(!o||!n.subject.trim()||!n.description.trim()){H.error("Veuillez remplir tous les champs obligatoires");return}u({subject:n.subject,description:n.description,category:n.category,priority:n.priority,status:"open",createdBy:o.id,createdByName:o.name}),H.success("Demande d'aide envoyÃ©e Ã  l'Ã©quipe FasoTravel"),i(!1),h({subject:"",description:"",category:"operational",priority:"medium"})},w=s=>{!o||!a.trim()||(N(s,a),H.success("Message envoyÃ©"),l(""),v(null))};return o?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx(ee,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Demandes d'Aide"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Contactez l'Ã©quipe d'administration FasoTravel pour obtenir de l'aide"})]}),e.jsxs(p,{onClick:()=>i(!0),className:"tf-btn-primary",children:[e.jsx(ce,{size:20,className:"mr-2"}),"Nouvelle demande"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1 space-y-4",children:e.jsxs(x,{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:"Contact Admin FasoTravel"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("a",{href:"tel:+22670123456",className:"flex items-center gap-3 p-3 bg-green-50 dark:bg-green-900/20 rounded-lg hover:bg-green-100 dark:hover:bg-green-900/30 transition-colors",children:[e.jsx("div",{className:"w-10 h-10 bg-green-600 rounded-full flex items-center justify-center",children:e.jsx(js,{className:"text-white",size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:"TÃ©lÃ©phone"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"+226 70 12 34 56"})]})]}),e.jsxs("a",{href:"mailto:support@fasotravel.bf",className:"flex items-center gap-3 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center",children:e.jsx(Ge,{className:"text-white",size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:"Email"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"support@fasotravel.bf"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-600 rounded-full flex items-center justify-center",children:e.jsx(is,{className:"text-white",size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:"Aide"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Lun-Ven: 8h-18h"})]})]})]})]})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(x,{className:"p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:["Mes demandes d'aide (",j.length,")"]}),j.length===0?e.jsx(ys,{icon:pe,title:"Aucune demande d'aide",description:"Cliquez sur 'Nouvelle demande' pour contacter l'Ã©quipe FasoTravel"}):e.jsx("div",{className:"space-y-4",children:j.map(s=>e.jsx(x,{className:"p-4 border-l-4 border-l-blue-500",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xl",children:ds(s.category)}),e.jsx("h3",{className:"font-bold text-gray-900 dark:text-white",children:s.subject}),e.jsxs(z,{className:cs(s.status),children:[e.jsx(xs,{size:14,className:"mr-1"}),ns(s.status)]}),e.jsx(z,{className:ms(s.priority),children:os(s.priority)})]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:["Par ",s.createdByName," â€¢ ",O(s.createdAt)]})]})}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:s.description}),s.messages&&s.messages.length>0&&e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 mb-2",children:"ðŸ’¬ Discussion avec l'Ã©quipe FasoTravel"}),s.messages.map(t=>e.jsxs("div",{className:`p-3 rounded-lg ${t.userId===o?.id?"bg-blue-50 dark:bg-blue-900/20 ml-8":"bg-green-50 dark:bg-green-900/20 mr-8"}`,children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:t.userId===o?.id?"Vous":"ðŸ‘¨â€ðŸ’¼ Ã‰quipe FasoTravel"}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:t.message}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:O(t.timestamp)})]},t.id))]}),s.status!=="closed"&&e.jsx("div",{className:"mt-3",children:y===s.id?e.jsxs("div",{className:"space-y-2",children:[e.jsx("textarea",{value:a,onChange:t=>l(t.target.value),placeholder:"Votre message Ã  l'Ã©quipe FasoTravel...",className:"w-full p-2 border rounded-lg dark:bg-gray-800 dark:border-gray-700",rows:3}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(p,{size:"sm",onClick:()=>w(s.id),disabled:!a.trim(),className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(gs,{size:14,className:"mr-2"}),"Envoyer Ã  l'admin"]}),e.jsx(p,{size:"sm",variant:"outline",onClick:()=>{v(null),l("")},children:"Annuler"})]})]}):e.jsxs(p,{size:"sm",variant:"outline",onClick:()=>v(s.id),children:[e.jsx(pe,{size:14,className:"mr-2"}),"RÃ©pondre Ã  l'admin"]})}),s.status==="closed"&&e.jsx("div",{className:"mt-3",children:e.jsx(z,{className:"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300",children:"âœ“ Ticket fermÃ© par l'Ã©quipe FasoTravel"})})]})},s.id))})]})})]}),e.jsx(Te,{open:g,onOpenChange:i,children:e.jsxs(ze,{className:"sm:max-w-[425px]",children:[e.jsxs(De,{children:[e.jsx(Ae,{children:"Nouvelle demande d'aide"}),e.jsx(Pe,{children:"Veuillez remplir les informations ci-dessous pour crÃ©er une nouvelle demande d'aide."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(A,{placeholder:"Sujet",value:n.subject,onChange:s=>h({...n,subject:s.target.value})}),e.jsx("textarea",{placeholder:"Description dÃ©taillÃ©e...",value:n.description,onChange:s=>h({...n,description:s.target.value}),className:"w-full p-2 border rounded-lg dark:bg-gray-800 dark:border-gray-700",rows:4}),e.jsxs(je,{value:n.category,onValueChange:s=>h({...n,category:s}),children:[e.jsx(ye,{className:"w-full",children:e.jsx(be,{placeholder:"CatÃ©gorie"})}),e.jsxs(Ne,{children:[e.jsx(F,{value:"technical",children:"ðŸ”§ Technique"}),e.jsx(F,{value:"financial",children:"ðŸ’° Financier"}),e.jsx(F,{value:"operational",children:"ðŸ“‹ OpÃ©rationnel"}),e.jsx(F,{value:"other",children:"ðŸ’¬ Autre"})]})]}),e.jsxs(je,{value:n.priority,onValueChange:s=>h({...n,priority:s}),children:[e.jsx(ye,{className:"w-full",children:e.jsx(be,{placeholder:"PrioritÃ©"})}),e.jsxs(Ne,{children:[e.jsx(F,{value:"low",children:"Basse"}),e.jsx(F,{value:"medium",children:"Moyenne"}),e.jsx(F,{value:"high",children:"Haute"}),e.jsx(F,{value:"urgent",children:"Urgente"})]})]})]}),e.jsxs("div",{className:"mt-4 flex gap-2 justify-end",children:[e.jsx(p,{size:"sm",variant:"outline",onClick:()=>i(!1),children:"Annuler"}),e.jsxs(p,{size:"sm",className:"tf-btn-primary",onClick:k,children:[e.jsx(ce,{size:14,className:"mr-2"}),"CrÃ©er la demande"]})]})]})})]}):null}function Ms(){return e.jsxs(_e,{children:[e.jsx(V,{path:"/",element:e.jsx($,{role:"manager",title:"Dashboard Manager",children:e.jsx(fs,{})})}),e.jsx(V,{path:"/carte",element:e.jsx($,{role:"manager",title:"Carte Locale",children:e.jsx(ks,{})})}),e.jsx(V,{path:"/caissiers",element:e.jsx($,{role:"manager",title:"Gestion Caissiers",children:e.jsx(ws,{})})}),e.jsx(V,{path:"/ventes",element:e.jsx($,{role:"manager",title:"Supervision Ventes",children:e.jsx(Cs,{})})}),e.jsx(V,{path:"/departs",element:e.jsx($,{role:"manager",title:"DÃ©parts du Jour",children:e.jsx(Ss,{})})}),e.jsx(V,{path:"/incidents",element:e.jsx($,{role:"manager",title:"Gestion Incidents",children:e.jsx(Ts,{})})}),e.jsx(V,{path:"/support",element:e.jsx($,{role:"manager",title:"Support Admin",children:e.jsx(zs,{})})})]})}export{Ms as default};
